<div class="container">
	<h2> Search a flight ! </h2>
	<form class="form" action="/search-flights" method="post">
		<%= hidden_field_tag :authenticity_token, form_authenticity_token %>

		<div class="form-row">
			<div class="col">
	  		<label for="filters[all-results]"> Show flights matching all filters or at least one filter ? </label>
				<div class="radio">
		  		<label>
		  			<input type="radio" name="filters[criteria]" value="true" > <%= "all".capitalize %>
		  		</label>
	  		</div>
				<div class="radio">	
		  		<label>
		  			<input type="radio" name="filters[criteria]" value="false" > <%= "at least One".capitalize %>
		  		</label>
		  	</div>
		  </div>
		</div>

		<div class="form-row">
			<div class="col">
				<label for="airport_departure"> From Airport </label>
				<select class="form-control js-example-basic-single" name="filters[airport][departure_code]">
					<option selected disabled hidden value=""> None </option>
					<% @codes.each do |code| %>
						<option value="<%= code %>"> <%= code %> </option>
					<% end %>
				</select>
			</div>

			<div class="col">
				<label for="airport_destination"> To Airport </label>
				<select class="form-control js-example-basic-single" name="filters[airport][destination_code]">
					<option selected disabled hidden value=""> None </option>
					<% @codes.each do |code| %>
						<option value="<%= code %>"> <%= code %> </option>
					<% end %>
				</select>
			</div>
		</div>

		<div class="form-row">
			<div class="col">
				<label for="filters[airport][departure]"> From City </label>
				<select class="form-control js-example-basic-single" name="filters[airport][departure_city]">
					<option selected disabled hidden value=""> None </option>
					<% @cities.each do |city| %>
						<option value="<%= city %>"> <%= city %> </option>
					<% end %>
				<!-- <input class="form-control" type="text" name="filters[airport][departure]" placeholder="From" /> -->
				</select>
			</div>
			<div class="col">
				<label for="filters[airport][destination]"> To City </label>
				<select class="form-control js-example-basic-single" name="filters[airport][destination_city]">
					<option selected="selected" value=""> None </option>
					<% @cities.each do |city| %>
						<option value="<%= city %>"> <%= city %> </option>
					<% end %>
				</select>
					<!-- <input class="form-control" type="text" name="filters[airport][destination]" placeholder="To" /> -->
			</div>
		</div>

		<div class="form-row">
			<div class="col">
				<label for=""> Date de départ </label>
				<input class="form-control datepicker" type="date" name="filters[flights][departure_date]" placeholder="From" />
			</div>

			<div class="col">
				<label for=""> Date d'arrivée </label>
				<input class="form-control datepicker"  type="date" name="filters[flights][arrival_date]" placeholder="To" />
			</div>
		</div>

		<div class="form-row">
			<div class="col">
				<input class="btn btn-primary" type="submit" value="Validate filters" />
			</div>
		</div>
	</form>
</div>

<div class="container">
	<div class="row">
		<div class="col-md-12">
			<form action="/prepare_booking" method="post" class="form form-horizontal">
				<%= hidden_field_tag :authenticity_token, form_authenticity_token %>
				<div class="form-row">
					<div class="col">
						<input type="submit" class="btn btn-primary" value="Book !"/>
					</div>
				</div>
				<div class="form-row">
					<div class="col">
						<label> Passengers </label>
						<input id="passengers_number" name="book[passengers]" type="number" min="1" max="5" value="1"/>
					</div>
				</div>
			<table class="table table-condensed">
				<thead>
					<tr>
						<th> Departure </th>
						<th> Destination </th>
						<th> Departure Date </th>
						<th> Arrival Date </th>
						<th> Booking </th>
					</tr>
				</thead>
				<tbody>
					<% @flights.each do |flight| %>
						<tr>
							<td>
								<%= flight.departure.country %> | <bold> <%= flight.departure.city%> </bold> | <%= flight.departure.airport_code %>
							</td>

							<td>
								<%= flight.destination.country %> | <bold> <%= flight.destination.city %> </bold> | <%= flight.destination.airport_code %>
							</td>

							<td>
								<%= flight.departure_date.strftime("%d/%m/%y") %>
								<br>
								<%= sprintf '%02d', flight.departure_hour %>:<%= sprintf '%02d', flight.departure_minutes %>
							</td>

							<td>
								<%= flight.arrival_date.strftime("%d/%m/%y") %>
								<br>
								<%= sprintf '%02d', flight.arrival_hour %>:<%= sprintf '%02d', flight.arrival_minutes %>
							</td>

							<td>
								<div class="form-row">
									<div class="col">
										<label> Book </label>
										<input name="book[flight_id]" type="radio" value="<%= flight.id %>"/>
									</div>
								</div>
							</td>
						</tr>
					<% end %>
				</tbody>
			</table>
			</form>
		</div>
	</div>
</div>
<script>
	$(document).ready(function() {
    $('.js-example-basic-single').select2();
  });
</script>